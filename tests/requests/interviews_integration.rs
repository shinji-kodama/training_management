use loco_rs::testing::prelude::*;
use serial_test::serial;
use training_management::app::App;

// ã€ãƒ†ã‚¹ãƒˆå¯¾è±¡ã€‘: é¢è«‡ï¼ˆInterviewsï¼‰çµ±åˆæ©Ÿèƒ½ã®ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
// ã€ãƒ†ã‚¹ãƒˆæ–¹é‡ã€‘: TDD Red Phase - å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆControllerå±¤æœªå®Ÿè£…ã«ã‚ˆã‚‹å¤±æ•—ï¼‰
// ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‘: Loco.rs 0.16.3 + Modelå±¤çµ±åˆ + SessionAuth + RBACçµ±åˆãƒ†ã‚¹ãƒˆ
// ğŸ”´ Red Phase: Controllerå±¤æœªå®Ÿè£…ã«ã‚ˆã‚Šçµ±åˆãƒ•ãƒ­ãƒ¼ãŒå„æ®µéšã§404å¤±æ•—

// =============================================================================
// TDD Red Phase: çµ±åˆå¤±æ•—ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆå®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœªå®Ÿè£…ãƒ†ã‚¹ãƒˆï¼‰
// =============================================================================

#[tokio::test]
#[serial]
async fn test_é¢è«‡äºˆç´„ã‹ã‚‰è¨˜éŒ²å®Œäº†ã¾ã§_å®Œå…¨ãƒ•ãƒ­ãƒ¼çµ±åˆå¤±æ•—() {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: é¢è«‡ç®¡ç†ã®å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆRed Phaseç‰ˆï¼‰
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: äºˆç´„ä½œæˆã‹ã‚‰è¨˜éŒ²å®Œäº†ã¾ã§ä¸€é€£ã®å‡¦ç†ãŒControlleræœªå®Ÿè£…ã«ã‚ˆã‚Šå„æ®µéšã§å¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§404 Not FoundãŒè¿”ã•ã‚Œã€çµ±åˆãƒ•ãƒ­ãƒ¼ãŒé€²è¡Œã—ãªã„
    // ğŸ”´ Red Phase: Controllerå±¤å®Œå…¨æœªå®Ÿè£…ã«ã‚ˆã‚‹ç¢ºå®Ÿãªçµ±åˆå¤±æ•—
    
    request::<App, _, _>(|request, _ctx| async move {
        // =============================================================================
        // Step 1: ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œï¼ˆèªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯å®Ÿè£…æ¸ˆã¿ã¨ä»®å®šï¼‰
        // =============================================================================
        
        // æ³¨æ„ï¼šèªè¨¼éƒ¨åˆ†ã¯åˆ¥ã‚¿ã‚¹ã‚¯ã§å®Ÿè£…æ¸ˆã¿ã®ãŸã‚ã€é¢è«‡é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã¿ã‚’ãƒ†ã‚¹ãƒˆ
        // å®Ÿéš›ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã¯èªè¨¼å¾Œã«é¢è«‡æ©Ÿèƒ½ã‚’ä½¿ç”¨
        
        // =============================================================================
        // Step 2: é¢è«‡ä½œæˆãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºè©¦è¡Œ
        // =============================================================================
        
        // ã€é¢è«‡ä½œæˆç”»é¢ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œã€‘: GET /interviews/new ã¸ã®æœªå®Ÿè£…ã‚¢ã‚¯ã‚»ã‚¹
        let new_form_response = request
            .get("/interviews/new")
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: é¢è«‡ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ç”»é¢æœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            new_form_response.status_code(),
            404,
            "ğŸ”´ Red Phase Step2: é¢è«‡ä½œæˆãƒ•ã‚©ãƒ¼ãƒ æœªå®Ÿè£…ã«ã‚ˆã‚Š404ãŒæœŸå¾…ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(new_form_response.status_code(), 200, "ğŸŸ¢ Green Phase Step2: é¢è«‡ä½œæˆãƒ•ã‚©ãƒ¼ãƒ æ­£å¸¸è¡¨ç¤º");
        // let form_html = new_form_response.text();
        // assert!(form_html.contains("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‚åŠ è€…"), "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‚åŠ è€…é¸æŠãƒ•ã‚©ãƒ¼ãƒ ãŒå«ã¾ã‚Œã‚‹");
        
        // =============================================================================
        // Step 3: é¢è«‡äºˆç´„ä½œæˆè©¦è¡Œ
        // =============================================================================
        
        // ã€é¢è«‡äºˆç´„ä½œæˆè©¦è¡Œã€‘: POST /interviews ã¸ã®æœªå®Ÿè£…ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        let create_response = request
            .post("/interviews")
            .json(&serde_json::json!({
                "project_participant_id": "550e8400-e29b-41d4-a716-446655440000",
                "interviewer_id": 1,
                "scheduled_at": "2024-12-15T14:00:00Z",
                "status": "scheduled",
                "notes": null
            }))
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: é¢è«‡ä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            create_response.status_code(),
            404,
            "ğŸ”´ Red Phase Step3: é¢è«‡ä½œæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404ãŒæœŸå¾…ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(create_response.status_code(), 201, "ğŸŸ¢ Green Phase Step3: é¢è«‡ä½œæˆæˆåŠŸã§201 Created");
        // let created_interview: serde_json::Value = create_response.json();
        // let interview_id = created_interview["id"].as_str().unwrap();
        
        // =============================================================================
        // Step 4: é¢è«‡ä¸€è¦§ç¢ºèªè©¦è¡Œ
        // =============================================================================
        
        // ã€é¢è«‡ä¸€è¦§è¡¨ç¤ºè©¦è¡Œã€‘: GET /interviews ã¸ã®æœªå®Ÿè£…ã‚¢ã‚¯ã‚»ã‚¹
        let list_response = request
            .get("/interviews")
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: é¢è«‡ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            list_response.status_code(),
            404,
            "ğŸ”´ Red Phase Step4: é¢è«‡ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404ãŒæœŸå¾…ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(list_response.status_code(), 200, "ğŸŸ¢ Green Phase Step4: é¢è«‡ä¸€è¦§æ­£å¸¸è¡¨ç¤º");
        // let list_html = list_response.text();
        // assert!(list_html.contains("scheduled"), "äºˆå®šçŠ¶æ…‹ã®é¢è«‡ãŒä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹");
        
        // =============================================================================
        // Step 5: é¢è«‡è©³ç´°è¡¨ç¤ºè©¦è¡Œ
        // =============================================================================
        
        // ã€é¢è«‡è©³ç´°è¡¨ç¤ºè©¦è¡Œã€‘: GET /interviews/{id} ã¸ã®æœªå®Ÿè£…ã‚¢ã‚¯ã‚»ã‚¹
        let test_interview_id = "550e8400-e29b-41d4-a716-446655440000";
        let detail_response = request
            .get(&format!("/interviews/{}", test_interview_id))
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: é¢è«‡è©³ç´°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            detail_response.status_code(),
            404,
            "ğŸ”´ Red Phase Step5: é¢è«‡è©³ç´°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404ãŒæœŸå¾…ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(detail_response.status_code(), 200, "ğŸŸ¢ Green Phase Step5: é¢è«‡è©³ç´°æ­£å¸¸è¡¨ç¤º");
        // let detail_html = detail_response.text();
        // assert!(detail_html.contains("scheduled_at"), "é¢è«‡äºˆå®šæ—¥æ™‚ãŒè¡¨ç¤ºã•ã‚Œã‚‹");
        
        // =============================================================================
        // Step 6: é¢è«‡è¨˜éŒ²æ›´æ–°è©¦è¡Œï¼ˆé¢è«‡å®Ÿæ–½å¾Œï¼‰
        // =============================================================================
        
        // ã€é¢è«‡è¨˜éŒ²æ›´æ–°è©¦è¡Œã€‘: PUT /interviews/{id} ã¸ã®æœªå®Ÿè£…ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        let update_response = request
            .put(&format!("/interviews/{}", test_interview_id))
            .json(&serde_json::json!({
                "status": "completed",
                "notes": "# é¢è«‡å®Œäº†è¨˜éŒ²\n\n## é€²æ—çŠ¶æ³\n- é †èª¿ã«é€²è¡Œä¸­\n\n## æ¬¡å›ç›®æ¨™\n- æ©Ÿèƒ½å®Œæˆ"
            }))
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: é¢è«‡æ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            update_response.status_code(),
            404,
            "ğŸ”´ Red Phase Step6: é¢è«‡æ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404ãŒæœŸå¾…ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(update_response.status_code(), 200, "ğŸŸ¢ Green Phase Step6: é¢è«‡è¨˜éŒ²æ›´æ–°æˆåŠŸ");
        // let updated_interview: serde_json::Value = update_response.json();
        // assert_eq!(updated_interview["status"], "completed", "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒcompletedã«æ›´æ–°ã•ã‚Œã‚‹");
        
        // =============================================================================
        // Step 7: æ›´æ–°ç¢ºèªè©¦è¡Œ
        // =============================================================================
        
        // ã€æ›´æ–°ç¢ºèªè©¦è¡Œã€‘: GET /interviews/{id} ã§æ›´æ–°å†…å®¹ç¢ºèªï¼ˆæœªå®Ÿè£…ã‚¢ã‚¯ã‚»ã‚¹ï¼‰
        let confirm_response = request
            .get(&format!("/interviews/{}", test_interview_id))
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: ç¢ºèªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            confirm_response.status_code(),
            404,
            "ğŸ”´ Red Phase Step7: æ›´æ–°ç¢ºèªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæœªå®Ÿè£…ã«ã‚ˆã‚Š404ãŒæœŸå¾…ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(confirm_response.status_code(), 200, "ğŸŸ¢ Green Phase Step7: æ›´æ–°ç¢ºèªæ­£å¸¸è¡¨ç¤º");
        // let confirm_data: serde_json::Value = confirm_response.json();
        // assert_eq!(confirm_data["status"], "completed", "æ›´æ–°ã•ã‚ŒãŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒç¢ºèªã§ãã‚‹");
        // assert!(confirm_data["notes"].as_str().unwrap().contains("é¢è«‡å®Œäº†è¨˜éŒ²"), "æ›´æ–°ã•ã‚ŒãŸè¨˜éŒ²ãŒç¢ºèªã§ãã‚‹");
    })
    .await;
}

#[tokio::test]
#[serial]
async fn test_æ¨©é™åˆ¥ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡_çµ±åˆå¤±æ•—() {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: 3ã¤ã®æ¨©é™ãƒ¬ãƒ™ãƒ«ã§ã®é¢è«‡ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆRed Phaseç‰ˆï¼‰
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: admin/trainer/instructorã®æ¨©é™å·®ç•°ãƒ†ã‚¹ãƒˆãŒControlleræœªå®Ÿè£…ã«ã‚ˆã‚Š404ã§çµ±ä¸€å¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: æ¨©é™ãƒ¬ãƒ™ãƒ«ã«é–¢ä¿‚ãªãå…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§404 Not FoundãŒè¿”ã•ã‚Œã‚‹
    // ğŸ”´ Red Phase: RBACçµ±åˆControlleræœªå®Ÿè£…ã«ã‚ˆã‚‹ç¢ºå®Ÿãªçµ±åˆå¤±æ•—
    
    request::<App, _, _>(|request, _ctx| async move {
        // =============================================================================
        // Adminæ¨©é™ãƒ†ã‚¹ãƒˆï¼ˆç¾åœ¨ã¯404ã§å¤±æ•—ï¼‰
        // =============================================================================
        
        // ã€Adminæ¨©é™é¢è«‡ä¸€è¦§ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œã€‘: æœ€é«˜æ¨©é™ã§ã‚‚404å¤±æ•—
        let admin_list_response = request
            .get("/interviews")
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: Adminæ¨©é™ã§ã‚‚Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            admin_list_response.status_code(),
            404,
            "ğŸ”´ Red Phase Admin: Controlleræœªå®Ÿè£…ã«ã‚ˆã‚ŠAdminæ¨©é™ã§ã‚‚404ãŒè¿”ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(admin_list_response.status_code(), 200, "ğŸŸ¢ Green Phase Admin: å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¢è«‡ä¸€è¦§è¡¨ç¤ºå¯èƒ½");
        
        // ã€Adminæ¨©é™é¢è«‡ä½œæˆè©¦è¡Œã€‘: æœ€é«˜æ¨©é™ã§ã‚‚404å¤±æ•—
        let admin_create_response = request
            .post("/interviews")
            .json(&serde_json::json!({
                "project_participant_id": "550e8400-e29b-41d4-a716-446655440000",
                "interviewer_id": 1,
                "scheduled_at": "2024-12-01T10:00:00Z",
                "status": "scheduled"
            }))
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: Adminæ¨©é™ã§ã‚‚Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            admin_create_response.status_code(),
            404,
            "ğŸ”´ Red Phase Admin: Controlleræœªå®Ÿè£…ã«ã‚ˆã‚ŠAdminä½œæˆã‚‚404ãŒè¿”ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(admin_create_response.status_code(), 201, "ğŸŸ¢ Green Phase Admin: é¢è«‡ä½œæˆæˆåŠŸ");
        
        // =============================================================================
        // Traineræ¨©é™ãƒ†ã‚¹ãƒˆï¼ˆç¾åœ¨ã¯404ã§å¤±æ•—ï¼‰
        // =============================================================================
        
        // ã€Traineræ¨©é™é¢è«‡ä¸€è¦§ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œã€‘: æ‹…å½“åˆ¶é™æ¨©é™ã§ã‚‚404å¤±æ•—
        let trainer_list_response = request
            .get("/interviews")
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: Traineræ¨©é™ã§ã‚‚Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            trainer_list_response.status_code(),
            404,
            "ğŸ”´ Red Phase Trainer: Controlleræœªå®Ÿè£…ã«ã‚ˆã‚ŠTraineræ¨©é™ã§ã‚‚404ãŒè¿”ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(trainer_list_response.status_code(), 200, "ğŸŸ¢ Green Phase Trainer: æ‹…å½“ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé¢è«‡ä¸€è¦§è¡¨ç¤ºå¯èƒ½");
        
        // =============================================================================
        // Instructoræ¨©é™ãƒ†ã‚¹ãƒˆï¼ˆç¾åœ¨ã¯404ã§å¤±æ•—ï¼‰
        // =============================================================================
        
        // ã€Instructoræ¨©é™é¢è«‡ä¸€è¦§ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œã€‘: èª­ã¿å–ã‚Šå°‚ç”¨æ¨©é™ã§ã‚‚404å¤±æ•—
        let instructor_list_response = request
            .get("/interviews")
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: Instructoræ¨©é™ã§ã‚‚Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Š404
        assert_eq!(
            instructor_list_response.status_code(),
            404,
            "ğŸ”´ Red Phase Instructor: Controlleræœªå®Ÿè£…ã«ã‚ˆã‚ŠInstructorèª­ã¿å–ã‚Šã‚‚404ãŒè¿”ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(instructor_list_response.status_code(), 200, "ğŸŸ¢ Green Phase Instructor: èª­ã¿å–ã‚Šå°‚ç”¨ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½");
        
        // ã€Instructoræ¨©é™é¢è«‡ä½œæˆè©¦è¡Œã€‘: èª­ã¿å–ã‚Šå°‚ç”¨æ¨©é™ã§ã®ä½œæˆæ“ä½œï¼ˆç¾åœ¨ã¯404å¤±æ•—ï¼‰
        let instructor_create_response = request
            .post("/interviews")
            .json(&serde_json::json!({
                "project_participant_id": "550e8400-e29b-41d4-a716-446655440000",
                "interviewer_id": 1,
                "scheduled_at": "2024-12-01T11:00:00Z",
                "status": "scheduled"
            }))
            .await;
        
        // ã€Red Phaseæ¤œè¨¼ã€‘: Instructoræ¨©é™ã§ã‚‚Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Š404ï¼ˆæ¨©é™ãƒã‚§ãƒƒã‚¯å‰ï¼‰
        assert_eq!(
            instructor_create_response.status_code(),
            404,
            "ğŸ”´ Red Phase Instructor: Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Šæ¨©é™åˆ¶å¾¡å‰ã«404ãŒè¿”ã•ã‚Œã‚‹"
        );
        
        // Green Phaseå¾Œã®æœŸå¾…å‹•ä½œï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰:
        // assert_eq!(instructor_create_response.status_code(), 403, "ğŸŸ¢ Green Phase Instructor: ä½œæˆæ“ä½œã¯403 Forbidden");
        
        // =============================================================================
        // æ¨©é™çµ±åˆãƒ†ã‚¹ãƒˆçµæœç¢ºèª
        // =============================================================================
        
        // ã€çµ±åˆãƒ†ã‚¹ãƒˆçµæœã€‘: ã™ã¹ã¦ã®æ¨©é™ãƒ¬ãƒ™ãƒ«ã§404ãŒçµ±ä¸€ã—ã¦è¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
        // ã€Red Phaseæ„å›³ã€‘: Controlleræœªå®Ÿè£…ã«ã‚ˆã‚Šæ¨©é™å·®ç•°ãŒç™ºç¾ã—ãªã„çŠ¶æ…‹ã‚’æ¤œè¨¼
        
        // ç¾åœ¨ã®çŠ¶æ…‹ï¼ˆRed Phaseï¼‰: å…¨æ¨©é™ã§404çµ±ä¸€
        // Green Phaseå¾Œã®æœŸå¾…: æ¨©é™ãƒ¬ãƒ™ãƒ«åˆ¥ã®é©åˆ‡ãªåˆ¶å¾¡ï¼ˆ200/201/403ï¼‰
        
        println!("ğŸ”´ Red Phaseçµ±åˆçµæœ: å…¨æ¨©é™ãƒ¬ãƒ™ãƒ«ã§Controlleræœªå®Ÿè£…ã«ã‚ˆã‚‹404ã‚¨ãƒ©ãƒ¼çµ±ä¸€");
        println!("ğŸŸ¢ Green Phaseç›®æ¨™: Admin(å…¨ã‚¢ã‚¯ã‚»ã‚¹), Trainer(æ‹…å½“åˆ¶é™), Instructor(èª­ã¿å–ã‚Šå°‚ç”¨)");
    })
    .await;
}